# DOMAIN_ROUTING_REGISTRY.yaml
# Status: authoritative
# Last verified: 2026-02-08
#
# Purpose:
#   Machine-readable SSOT mapping for: hostname -> routing layer -> authority.
#
# Non-negotiables:
#   - Docs-only. This file does NOT change DNS, Cloudflare tunnel ingress, or runtime routing.
#   - Secrets rotation and git history rewrite are explicitly deferred.
#
# Update procedure (docs-only):
#   1) Export live tunnel ingress (hostname -> service):
#        ./bin/ops cap run cloudflare.tunnel.ingress.status
#   2) Update this registry with any new/changed hostnames (set routing_layer accordingly).
#   3) Gate the drift:
#        ./bin/ops cap run cloudflare.domain_routing.diff
#   4) DNS exports live in workbench for reference:
#        /Users/ronnyworks/code/workbench/infra/cloudflare/exports/*
#
# Field notes:
#   - routing_layer: one of [cloudflare_tunnel, direct, unknown]
#   - authority_source: where edits happen today [cloudflare_dashboard, repo_script, compose_labels, unknown]
#   - target_hint: optional human hint (docker dns name, tailscale ip, etc). Keep non-sensitive.
#   - references: repo file paths that mention/relate to the hostname/routing.
#
version: 1

zones:
  - zone: ronny.works
    source:
      dns_export_file: "workbench:infra/cloudflare/exports/dns-records-2025-12-24.json"
      note: "DNS export lives in workbench; this file is the spine SSOT for documented routing."
    hostnames:
      - hostname: ronny.works
        service: TBD
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Apex domain; no service deployed yet"
        references:
          - workbench:infra/cloudflare/exports/dns-records-2025-12-24.json

      - hostname: www.ronny.works
        service: TBD
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Apex www redirect; no service deployed yet"
        references:
          - workbench:infra/cloudflare/exports/dns-records-2025-12-24.json

      - hostname: secrets.ronny.works
        service: secrets
        stack: ops/staged/secrets
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://127.0.0.1:80 (Caddy on infra-core -> Infisical :8088)"
        references:
          - ops/staged/secrets/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml
          - ops/staged/caddy-auth/docker-compose.yml

      - hostname: files.ronny.works
        service: minio
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://minio:9000 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: mintprints-api.ronny.works
        service: mintprints-api
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-dashboard-api:3335 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      # Newly added for completeness from DNS export (routing/ownership may be TBD)
      - hostname: chat.ronny.works
        service: TBD
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.98.70.70:3000 (automation-stack)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: dash.ronny.works
        service: dashy
        stack: workbench:infra/compose/dashy
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.92.156.118:4000 (docker-host)"
        references:
          - workbench:infra/compose/dashy/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: docs.ronny.works
        service: paperless-ngx
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://paperless-ngx:8000 (docker-host via cloudflared extra_hosts)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: finances.ronny.works
        service: firefly-iii
        stack: finance
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://firefly-iii:8080 (docker-host via cloudflared extra_hosts)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: firefly.ronny.works
        service: firefly-iii
        stack: finance
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://firefly-iii:8080 (docker-host via cloudflared extra_hosts)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: grafana.ronny.works
        service: grafana
        stack: ops/staged/observability/grafana
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://grafana:3000 (resolved by cloudflared connector)"
        references:
          - ops/staged/cloudflared/docker-compose.yml
          - ops/staged/observability/grafana/docker-compose.yml

      - hostname: ha.ronny.works
        service: home-assistant
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.67.120.1:8123 (ha)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: investments.ronny.works
        service: ghostfolio
        stack: finance
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://ghostfolio:3333 (docker-host via cloudflared extra_hosts)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: jellyfin.ronny.works
        service: jellyfin
        stack: media-stack
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.117.1.53:8096 (media-stack legacy VM)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: kanban.ronny.works
        service: kanban
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.92.156.118:3337 (docker-host)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: mail-archive.ronny.works
        service: mail-archiver
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.92.156.118:5100 (docker-host)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: minio.ronny.works
        service: minio
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://minio:9001 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: mintprints-app.ronny.works
        service: mintprints-app
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-customer:3334 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.frontends.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: mintprints-v3.ronny.works
        service: mintprints-v3
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "https://print-shop-os--hypnotizedent.github.app"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: music.ronny.works
        service: navidrome
        stack: media-stack
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.117.1.53:4533 (media-stack legacy VM)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: n8n.ronny.works
        service: n8n
        stack: workbench:infra/compose/n8n
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.98.70.70:5678 (automation-stack)"
        references:
          - workbench:infra/compose/n8n/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: photos.ronny.works
        service: immich
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.83.160.109:2283 (immich)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: production.ronny.works
        service: production
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-production:3336 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: requests.ronny.works
        service: requests
        stack: media-stack
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.117.1.53:5055 (media-stack legacy VM)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: git.ronny.works
        service: gitea
        stack: gitea
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "100.90.167.39:3000 (dev-tools VM 206)"
        references:
          - ops/staged/dev-tools/gitea/docker-compose.yml

      - hostname: auth.ronny.works
        service: authentik
        stack: caddy-auth
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "127.0.0.1:80 (Caddy on infra-core → Authentik :9000)"
        references:
          - ops/staged/caddy-auth/docker-compose.yml

      - hostname: pihole.ronny.works
        service: pihole
        stack: pihole
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "127.0.0.1:80 (Caddy on infra-core → Pi-hole :8053)"
        references:
          - ops/staged/pihole/docker-compose.yml

      - hostname: vault.ronny.works
        service: vaultwarden
        stack: vaultwarden
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "127.0.0.1:80 (Caddy on infra-core → Vaultwarden :8081)"
        references:
          - ops/staged/vaultwarden/docker-compose.yml

  - zone: mintprints.co
    source:
      dns_export_file: "workbench:infra/cloudflare/exports/dns-records-mintprints-co-2026-01-23.json"
      note: "DNS export lives in workbench; this file is the spine SSOT for documented routing."
    hostnames:
      - hostname: mintprints.co
        service: TBD
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Apex domain; no service deployed yet"
        references:
          - workbench:infra/cloudflare/exports/dns-records-mintprints-co-2026-01-23.json

      - hostname: www.mintprints.co
        service: TBD
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Apex www redirect; no service deployed yet"
        references:
          - workbench:infra/cloudflare/exports/dns-records-mintprints-co-2026-01-23.json

      - hostname: admin.mintprints.co
        service: admin
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-admin:3333 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: api.mintprints.co
        service: api
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-dashboard-api:3335 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: customer.mintprints.co
        service: customer
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-customer:3334 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: production.mintprints.co
        service: production
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-production:3336 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: files.mintprints.co
        service: minio
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-minio:9000 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: artwork.mintprints.co
        service: artwork
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Domain registered but service not deployed"
        references:
          - infrastructure/domains/DOMAIN_REGISTRY.md

      - hostname: shipping.mintprints.co
        service: shipping
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-dashboard-api:3335 (docker-host 100.92.156.118)"
        note: "Was previously documented as Pages; tunnel ingress verified 2026-02-08"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: suppliers.mintprints.co
        service: suppliers
        stack: mint-os/apps/suppliers
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        references:
          - infrastructure/domains/DOMAIN_REGISTRY.md
          - mint-os/docs/modules/suppliers/INDEX.md
          - mint-os/docs/modules/suppliers/SPEC.md

      - hostname: estimator.mintprints.co
        service: estimator
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-job-estimator:3001 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: kanban.mintprints.co
        service: kanban
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-kanban:3337 (docker-host 100.92.156.118)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: mcp.mintprints.co
        service: mcp
        stack: workbench:infra/compose/mcpjungle
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mcpjungle:8080 (docker-host via cloudflared extra_hosts)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mcpjungle/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: minio.mintprints.co
        service: minio
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://mint-os-minio:9001 (docker-host 100.92.156.118)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: pricing.mintprints.co
        service: pricing
        stack: workbench:infra/compose/mint-os
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.92.156.118:3001 (docker-host)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - workbench:infra/compose/mint-os/docker-compose.yml
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: send.mintprints.co
        service: send
        stack: TBD
        routing_layer: unknown
        authority_source: unknown
        target_hint: ""
        note: "Domain registered but service not deployed"
        references:
          - infrastructure/domains/DOMAIN_REGISTRY.md

      - hostname: stock-dst.mintprints.co
        service: stock-dst
        stack: TBD
        routing_layer: cloudflare_tunnel
        authority_source: cloudflare_dashboard
        target_hint: "http://100.92.156.118:8765 (docker-host)"
        note: "Active (tunnel ingress verified 2026-02-08)"
        references:
          - ops/staged/cloudflared/docker-compose.yml

      - hostname: _dmarc.mintprints.co
        service: dmarc
        stack: TBD  # DNS-only record, no compose stack
        routing_layer: direct
        authority_source: cloudflare_dashboard
        target_hint: "DNS policy record"
        note: "DNS-only record, no routing target"
        references:
          - infrastructure/domains/DOMAIN_REGISTRY.md

      - hostname: resend._domainkey.mintprints.co
        service: dkim
        stack: TBD  # DNS-only record, no compose stack
        routing_layer: direct
        authority_source: cloudflare_dashboard
        target_hint: "DKIM record (Resend)"
        note: "DNS-only record, no routing target"
        references:
          - infrastructure/domains/DOMAIN_REGISTRY.md
