version: "1.0"
contract_id: "W52_FOUNDATIONAL_CONTAINMENT_CONTRACT_V1"
status: "report-first"
owner: "@ronny"
last_verified: "2026-02-27"
date_anchor: "2026-02-27"
source_of_truth:
  - docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
  - docs/planning/W51_D_NEXT_NATURAL_STEPS.md
  - docs/planning/W51_E_WEEKEND_UPGRADE_PROGRAM.md
  - docs/planning/W51_EXECUTION_PIPELINE.json
loop_id: "LOOP-SPINE-W52-CONTAINMENT-AUTOMATION-20260227-20260301"
mode:
  default_policy: report
  w52b_target_policy: enforce
  promotion_window:
    earliest: "2026-03-01"
    latest: "2026-03-08"
controls:
  D252:
    gate_id: D252
    title: "container-oom-exit-lock"
    finding_rank: 1
    finding_summary: "Container OOM exits are not governed by containment policy or escalation routing."
    source_evidence:
      path: docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
      marker: "containers stopped with OOM (137) exits"
    linked_gap_id: GAP-OP-1018
    policy:
      report_mode: true
      enforce_mode_allowed: true
      promotion_target: W52B
      promotion_criteria:
        - "OOM exit classifies each affected service as expected-stopped, restart-required, or incident-required."
        - "Escalation routing is codified in handoff SOP and includes terminal role ownership."
        - "Two consecutive verify runs show zero unresolved HIGH findings for D252 in enforce mode."
  D253:
    gate_id: D253
    title: "service-health-state-aware-lock"
    finding_rank: 2
    finding_summary: "Health probes do not distinguish intentionally stopped services from degraded expected-running services."
    source_evidence:
      path: docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
      marker: "Health probes failing for stopped containers"
    linked_gap_id: GAP-OP-1019
    policy:
      report_mode: true
      enforce_mode_allowed: true
      promotion_target: W52B
      promotion_criteria:
        - "services.health policy includes explicit expected_running state semantics."
        - "False degraded alerts for intentionally stopped services are reduced to zero across two daily snapshots."
        - "communications and mint verify packs pass with D253 in enforce mode."
  D254:
    gate_id: D254
    title: "image-age-budget-lock"
    finding_rank: 3
    finding_summary: "Image freshness has no governed age budget, allowing stale security posture on critical services."
    source_evidence:
      path: docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
      marker: "minio image 173 days old"
    linked_gap_id: GAP-OP-1020
    policy:
      report_mode: true
      enforce_mode_allowed: true
      promotion_target: W52B
      promotion_criteria:
        - "Age budget thresholds are explicit for critical and standard image classes."
        - "Any image above critical threshold triggers deterministic incident receipt requirement."
        - "MinIO image is below critical threshold for two consecutive enforce runs."
  D255:
    gate_id: D255
    title: "md1400-capacity-monitor-lock"
    finding_rank: 4
    finding_summary: "MD1400 capacity visibility and guardrails are missing from governed operations."
    source_evidence:
      path: docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
      marker: "No MD1400 capacity monitoring"
    linked_gap_id: GAP-OP-1021
    policy:
      report_mode: true
      enforce_mode_allowed: true
      promotion_target: W53
      promotion_criteria:
        - "Capacity baseline artifact is generated and attached to receipt lane."
        - "Warn and critical thresholds are bound to MD1400 headroom percentages."
        - "Capacity guard is executed in nightly or scheduled verify surface with no policy drift."
  D256:
    gate_id: D256
    title: "credential-spof-lock"
    finding_rank: 10
    finding_summary: "Operational authentication depends on single-operator credentials with no redundancy contract."
    source_evidence:
      path: docs/planning/W51_FOUNDATIONAL_FORENSIC_AUDIT_MASTER_RECEIPT.md
      marker: "Single point of failure (Ronny credentials)"
    linked_gap_id: GAP-OP-1022
    policy:
      report_mode: true
      enforce_mode_allowed: true
      promotion_target: W53
      promotion_criteria:
        - "At least two governed operators/roles can execute critical recovery capabilities."
        - "Break-glass flow is documented with auditable receipt capture requirements."
        - "Credential dependency matrix contains no single-operator critical path without escalation fallback."
protected_lane_attestation:
  untouched:
    - LOOP-MAIL-ARCHIVER-MICROSOFT-DEEP-IMPORT-20260226
    - GAP-OP-973
    - ews-import
    - md1400-rsync
