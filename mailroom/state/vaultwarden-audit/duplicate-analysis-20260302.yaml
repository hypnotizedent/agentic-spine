---
# Vaultwarden Canonical Audit — Duplicate Analysis
# W2: Duplicate forensics

audit_id: VW-AUDIT-20260302
wave: W2
data_source: phone_export_456_items

methodology:
  fingerprint: "name|primary_domain|username_sha256_prefix"
  exact_duplicate: "Same canonical fingerprint (same name + domain + username hash)"
  likely_duplicate: "Same domain + same name, different username or username class"
  conflict_duplicate: "Same domain, different names (potentially same service, different records)"

# ─── EXACT DUPLICATES ───

exact_duplicate_groups: 2
exact_duplicate_total_items: 4

exact_duplicates:
  - fingerprint_class: "util-730xd|util-730xd|*"
    count: 2
    all_active: true
    items:
      - id_prefix: "(item-1)"
        name: "util-730xd"
        username_class: non-email
      - id_prefix: "(item-2)"
        name: "util-730xd"
        username_class: non-email
    safe_to_dedupe: false
    reason: "Both active — need manual review to pick keeper"

  - fingerprint_class: "bitwarden mint|(none)|*"
    count: 2
    all_active: true
    items:
      - id_prefix: "76053e25"
        name: "bitwarden mint"
        username_class: non-email
        has_uri: false
      - id_prefix: "902f8d76"
        name: "bitwarden mint"
        username_class: non-email
        has_uri: false
    safe_to_dedupe: false
    reason: "Both active, no URIs — need manual content comparison"

# ─── LIKELY DUPLICATES ───

likely_duplicate_groups: 15
likely_duplicate_total_items: 32

likely_duplicates:
  - domain: "100.92.156.118"
    count: 4
    items_summary: "4 items, usernames=[non-email, email, non-email, non-email]"
    risk: high
    note: "Tailscale IP — likely Uptime Kuma/Infisical on same host, different services"

  - domain: "www.instagram.com"
    count: 3
    items_summary: "3 'instagram.com' items, all non-email usernames"
    risk: high
    note: "Very likely duplicates — same service, 3 records"

  - domain: "app.n8n.cloud"
    count: 2
    items_summary: "1 email + 1 non-email username"
    risk: medium
    note: "Could be cloud + self-hosted accounts"

  - domain: "x.com"
    count: 2
    risk: medium

  - domain: "localhost"
    count: 2
    items_summary: "1 email + 1 non-email"
    risk: low
    note: "Ephemeral localhost entries from development"

  - domain: "www.paypal.com"
    count: 2
    items_summary: "Both email usernames"
    risk: high
    note: "Same service — likely personal + business accounts or true dupe"

  - domain: "ne7.ondemand.esker.com"
    count: 2
    risk: medium

  - domain: "192.168.12.107"
    count: 2
    items_summary: "Both email — Immich at different IPs"
    risk: high

  - domain: "homeassistant.local"
    count: 2
    risk: medium
    note: "Stale .local alias — should be consolidated to ha.ronny.works"

  - domain: "192.168.12.113"
    count: 2
    items_summary: "Both email — likely Immich"
    risk: high

  - domain: "100.117.1.53"
    count: 2
    risk: medium

  - domain: "account.humana.com"
    count: 2
    risk: medium

  - domain: "app.frontapp.com"
    count: 2
    risk: medium

  - domain: "util-730xd"
    count: 2
    risk: medium
    note: "Also in exact-dupe group"

  - domain: "app.hubspot.com"
    count: 2
    risk: medium

# ─── CONFLICT DUPLICATES ───

conflict_duplicate_groups: 12
conflict_duplicate_total_items: 28

conflict_duplicates:
  - domain: "192.168.12.133"
    names: ["sonarr", "jellyfin", "radarr"]
    count: 3
    risk: low
    note: "Different services on same host — NOT duplicates, correct records"

  - domain: "accounts.google.com"
    names: ["Ronny gmail", "Mint Gmail", "accounts.google.com"]
    count: 3
    risk: medium
    note: "Multiple Google accounts — possibly correct, but 'accounts.google.com' may be a dupe"

  - domain: "vault.taile9480.ts.net"
    names: ["vault.taile9480.ts.net", "Vault login"]
    count: 2
    risk: high
    note: "Duplicate vault entries — should be consolidated to vault.ronny.works"

  - domain: "10.0.0.1"
    names: ["Unifi", "10.0.0.1"]
    count: 2
    risk: high
    note: "Same device, different names — consolidate"

  - domain: "100.71.140.102"
    names: ["bazarr", "huntarr"]
    count: 2
    risk: low
    note: "Different services on same host — correct records"

  - domain: "192.168.12.236"
    names: ["192.168.12.236", "https://192.168.12.179:80"]
    count: 2
    risk: medium
    note: "PVE entries with different IP references"

  - domain: "www.reddit.com"
    names: ["reddit.com", "www.reddit.com"]
    count: 2
    risk: high
    note: "Likely dupe — same service"

  - domain: "www.printavo.com"
    names: ["printavo.com", "printavo.com - Mint"]
    count: 2
    risk: medium
    note: "Possibly personal + business accounts"

  - domain: "account.t-mobile.com"
    names: ["Tmobile Mint", "TMobile Personal"]
    count: 2
    risk: low
    note: "Different accounts — correct records"

  - domain: "account.apple.com"
    names: ["account.apple.com", "Apple - Mint"]
    count: 2
    risk: low
    note: "Personal + business Apple IDs — correct records"

  - domain: "www.usenet-crawler.com"
    names: ["www.usenet-crawler.com", "usenet-crawler.com"]
    count: 2
    risk: high

  - domain: "accounts.shopify.com"
    names: ["accounts.shopify.com", "Shopify"]
    count: 2
    risk: high
    note: "Likely dupe — same service"

# ─── BACKFILL RISK ───

backfill_duplicate_risk:
  reported_backfill_count: 39
  backfill_artifact_found: false
  null_username_items: 9
  null_username_items_detail:
    - name: "books.zoho.com"
    - name: "Staples"
    - name: "Dicks sporting goods"
    - name: "truss"
    - name: "Ez6yuBh1lCwAhF"
    - name: "Apple ID pass key"
    - name: "Empower"
    - name: "my-pricing-tool"
    - name: "T-Mobile"
  assessment: >
    The backfill reportedly created 39 items with 0 errors. With null-username
    items as the reported risk vector, the 9 null-username items in the export
    are the most likely candidates for having been duplicated. However, without
    the apply result artifact or live vault access, the exact duplicate set
    cannot be confirmed. The 39-item backfill may have also included items
    not in the export (if the backfill source was different).

# ─── STALE URL ITEMS ───

stale_url_items: 34
stale_url_patterns:
  old_shop_lan_ip: 20  # 192.168.12.*
  tailscale_cgnat_ip: 5  # 100.*
  old_vault_alias: 2  # vault.taile9480.ts.net
  dot_internal: 4  # *.internal
  homeassistant_local: 2
  localhost: 2

# ─── SUMMARY ───

summary:
  total_items_analyzed: 456
  safe_dedupe_candidates: 0  # No trashed dupes (export excludes trash)
  unsafe_dedupe_candidates: 2  # Exact dupes needing manual review
  likely_dupe_investigation: 15  # Groups needing owner review
  conflict_groups_needing_review: 6  # High-risk conflict groups
  stale_url_cleanup_candidates: 34
  null_username_risk_items: 9
  backfill_unverified_items: 39
  items_without_uris: 34  # Login items missing URI
