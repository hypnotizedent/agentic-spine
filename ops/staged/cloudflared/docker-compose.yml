services:
  cloudflared:
    image: cloudflare/cloudflared:latest
    container_name: homelab-cloudflared
    restart: unless-stopped
    network_mode: host
    command: tunnel --no-autoupdate --metrics 0.0.0.0:60123 run
    environment:
      - TUNNEL_TOKEN=${CLOUDFLARE_TUNNEL_TOKEN:?CLOUDFLARE_TUNNEL_TOKEN required}
    dns:
      - 1.1.1.1
      - 8.8.8.8
    extra_hosts:
      - host.docker.internal:host-gateway
      # Mint OS services (docker-host 100.92.156.118)
      - mint-os-dashboard-api:100.92.156.118
      - mint-os-admin:100.92.156.118
      - mint-os-production:100.92.156.118
      - mint-os-kanban:100.92.156.118
      - mint-os-job-estimator:100.92.156.118
      - mint-os-minio:100.92.156.118
      - minio:100.92.156.118
      - files-api:100.79.183.14
      - quote-page:100.79.183.14
      # Local services (infra-core)
      - infisical:127.0.0.1
      - mcpjungle:100.98.70.70
      - grafana:100.120.163.70
      # Finance services (finance-stack VM 211 â€” 100.76.153.100)
      # Cutover: LOOP-FINANCE-VM-SEPARATION-20260211 P4
      - firefly-iii:100.76.153.100
      - ghostfolio:100.76.153.100
      - paperless-ngx:100.76.153.100
      - mail-archiver:100.76.153.100
