{
    email {$ACME_EMAIL}
}

# Authentik UI/API
{$AUTHENTIK_HOSTNAME} {
    reverse_proxy 127.0.0.1:9000
}

# Grafana protected with Authentik forward auth.
# Requires an Authentik proxy provider/outpost configured for this hostname.
{$GRAFANA_HOSTNAME} {
    forward_auth 127.0.0.1:9000 {
        uri /outpost.goauthentik.io/auth/caddy
        copy_headers X-Authentik-Username X-Authentik-Groups X-Authentik-Email
        trusted_proxies private_ranges
    }
    reverse_proxy {$GRAFANA_UPSTREAM}
}
