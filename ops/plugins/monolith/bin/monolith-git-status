#!/usr/bin/env bash
set -euo pipefail

# monolith.git_status wrapper:
# - Capability runs from $HOME/code; this maps <repo> -> $HOME/code/<repo>.
# - Uses `git -C` so we don't depend on the caller's CWD being inside a repo.

repo="${1:-agentic-spine}"

base="${HOME}/code"

if [[ "$repo" == /* ]]; then
  repo_dir="$repo"
else
  repo_dir="${base}/${repo}"
fi

if [[ ! -d "$repo_dir" ]]; then
  echo "ERROR: repo not found: $repo_dir" >&2
  exit 2
fi

if [[ ! -e "$repo_dir/.git" ]]; then
  echo "ERROR: not a git repo (missing .git): $repo_dir" >&2
  exit 2
fi

git -C "$repo_dir" status

