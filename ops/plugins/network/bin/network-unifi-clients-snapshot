#!/usr/bin/env bash
# network-unifi-clients-snapshot â€” Snapshot UniFi client list (MAC/IP/name)
#
# Thin wrapper around unifi-agent.sh clients.
# Registered as capability: network.unifi.clients.snapshot
#
# Exit:
#   0  OK
#   1  FAIL
#   2  STOP (missing deps)
#
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SPINE_ROOT="${SPINE_ROOT:-$(cd "$SCRIPT_DIR/../../../.." && pwd)}"
AGENT="$SPINE_ROOT/ops/tools/unifi-agent.sh"

[[ -f "$AGENT" ]] || { echo "STOP (2): missing unifi-agent.sh at $AGENT"; exit 2; }
[[ -x "$AGENT" ]] || { echo "STOP (2): unifi-agent.sh not executable"; exit 2; }

echo "network.unifi.clients.snapshot"
echo

"$AGENT" clients "$@"
