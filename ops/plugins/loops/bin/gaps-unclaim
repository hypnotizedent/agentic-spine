#!/usr/bin/env bash
set -euo pipefail

# gaps.unclaim â€” Release a gap claim
#
# Usage: gaps-unclaim <GAP_ID>
#
# Removes the claim file. Only the owning process (or stale-recovery)
# can release a claim.

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/../../../.." && pwd)"
source "$ROOT/ops/plugins/loops/lib/gap-claims.sh"

if [[ "${1:-}" == "-h" || "${1:-}" == "--help" ]]; then
  echo "Usage: gaps-unclaim <GAP_ID>"
  exit 0
fi

GAP_ID="${1:?Usage: gaps-unclaim <GAP_ID>}"

unclaim_gap "$GAP_ID" || exit 1

echo "UNCLAIMED: $GAP_ID"
