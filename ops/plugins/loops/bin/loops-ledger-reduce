#!/usr/bin/env bash
set -euo pipefail

# loops-ledger-reduce - DEPRECATED (scope files are now canonical)
#
# This script previously deduplicated open_loops.jsonl (append-only JSONL).
# Loop state now lives in mailroom/state/loop-scopes/*.scope.md.
# Use: ops loops summary (reads scope file frontmatter)
#
# Kept as a thin wrapper to avoid breaking capability references.

SPINE_REPO="${SPINE_REPO:-$HOME/code/agentic-spine}"
SCOPES_DIR="$SPINE_REPO/mailroom/state/loop-scopes"

case "${1:-}" in
    -h|--help)
        echo "loops-ledger-reduce - DEPRECATED"
        echo ""
        echo "Loop state moved from open_loops.jsonl to scope files."
        echo "Use: ops loops summary"
        exit 0
        ;;
esac

# Delegate to loops.sh summary for --summary mode
exec "$SPINE_REPO/ops/commands/loops.sh" summary
