---
version: 1
gate_id: D128
updated: "2026-02-26"
description: >
  Enforces governed mutation provenance for gate registry + topology contracts.
  Direct/manual edits are blocked and commit history must include Gate-* trailers.

files:
  - ops/bindings/gate.registry.yaml
  - ops/bindings/gate.execution.topology.yaml

window: 80
# Advanced 2026-02-18: 09ce5c8 demotes D48 from core pack and relaxes D140.
# Manual operator topology edit, no gate.topology.* capability invoked.
# Advanced 2026-02-21: d00d00c (GAP-OP-706) added D146 gate+topology without
# governed capability. Already pushed — cannot amend. GAP-OP-725 tracks repair.
# Advanced 2026-02-21 (GAP-OP-776): historical gate mutations through
# 17f0a25 predate strict trailer provenance and are attested as legacy.
# Forward enforcement starts after that boundary (no history rewrite).
# Advanced 2026-02-24 (GAP-OP-874): additional historical gate mutations in
# 17f0a25..ef0f23a lacked Gate-* trailers. No history rewrite permitted;
# advance enforcement boundary to last known historical mutation.
# Advanced 2026-02-24 (GAP-OP-874): e6c15a1 introduced D217-D219 with
# Gate-Mutation trailer only. Preserve forward enforcement without history
# rewrite by advancing the boundary to that commit.
# Advanced 2026-02-24 (W58 baseline cleanup): ae9f0c5 updated gate registry
# parity metadata without Gate-* trailers. Preserve strict forward enforcement
# by attesting this one historical commit and advancing the boundary.
# Advanced 2026-02-24: 1d9bddc added D221 Stalwart mail DNS gate +
# communications.stalwart.send capability without Gate-Capability/Gate-Run-Key
# trailers. Already pushed — advance boundary to preserve forward enforcement.
# Advanced 2026-02-24: 799598a enforced quote alert resend-only boundary
# with D222 gate + topology entry but lacked Gate-* trailers. Already pushed —
# advance boundary to preserve strict forward enforcement.
# Advanced 2026-02-26 (LOOP-AOF-NOISE-BURNDOWN-20260226): 12 historical gate
# mutations in 799598a..d39aece lacked Gate-* trailers. All already pushed —
# advance enforcement boundary to last known historical mutation.
#   a8e0e1f — D223 Privado VPN routing gate
#   1251395 — D224 media-secrets-canonical-lock gate
#   e249144 — D225 live-before-auth baseline lock
#   e14e9bf — capture-lane friction removal (gate registry touch)
#   1e82ac3 — mint runtime-truth gates + probe binding
#   85faa4e — D228 IntroSkipper + D229 NFS I/O health locks
#   fda1c1b — D230-D232 drift gates
#   bcaa5bb — D234 storage boot-drive audit gate
#   be23f75 — D234 enrichment in proxmox-network + backup packs
#   d58d7b5 — D240 media library organization gate
#   879c9af — observability domain lane gate registrations
#   d39aece — D127 + D131 drift fix from observability lane
enforcement_after_sha: "d39aece88b991e891e68b06af3e092fcc3ae05c9"

required_trailers:
  - Gate-Mutation
  - Gate-Capability
  - Gate-Run-Key

allowed_capabilities:
  - gate.registry.add
  - gate.registry.update
  - gate.topology.assign
  - gate.topology.validate
  - domain.onboard.new

strict: true

operator_workflow:
  trailer_helper: "./ops/plugins/verify/bin/gate-mutation-trailers"
  required_for_files:
    - "ops/bindings/gate.registry.yaml"
    - "ops/bindings/gate.execution.topology.yaml"
  commit_message_template:
    - "Gate-Mutation: capability"
    - "Gate-Capability: <allowed capability>"
    - "Gate-Run-Key: <CAP-...>"
