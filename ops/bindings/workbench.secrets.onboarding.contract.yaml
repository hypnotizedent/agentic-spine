status: authoritative
owner: "@ronny"
last_verified: 2026-02-23
scope: workbench-secrets-onboarding-enforcement
workbench_root: /Users/ronnyworks/code/workbench
checks:
  - id: no_inline_universal_auth_login
    description: Governed onboarding scripts must not call Infisical universal-auth login directly.
    include_paths:
      - scripts/root/setup-oidc-cicd.sh
    forbidden_patterns:
      - universal-auth/login
    enforce: true
  - id: no_infisical_cli_login_export
    description: Governed onboarding scripts must not use infisical login/export directly.
    include_paths:
      - scripts/root/sync-secrets-to-env.sh
      - scripts/root/test-infisical.sh
    forbidden_patterns:
      - infisical login
      - infisical export
    enforce: true
  - id: no_mutating_infisical_set_in_onboarding_scripts
    description: Governed onboarding scripts must not write secrets via infisical-agent set.
    include_paths:
      - scripts/root/setup-oidc-cicd.sh
    forbidden_patterns:
      - scripts/agents/infisical-agent.sh set
    enforce: true
  - id: no_open_high_critical_inventory_issues
    description: Secrets inventory must not retain unresolved HIGH or CRITICAL issues.
    inventory_file: infra/data/secrets_inventory.json
    severities:
      - CRITICAL
      - HIGH
    enforce: true
exceptions:
  - path: infra/data/secrets_inventory.json::no_open_high_critical_inventory_issues
    reason: unresolved HIGH/CRITICAL inventory issues remain open and require operational remediation outside this controlled docs/surface wave.
    owner: "@ronny"
    expires_on: 2026-03-01
    ticket_id: WORKBENCH-W2-EXCEPTION-BURNDOWN
