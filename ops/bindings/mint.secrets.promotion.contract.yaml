# Status: authoritative
# Last verified: 2026-02-27
# Purpose: W45 shipping/payment/notifications secret alias normalization and promotion lock.

version: 1
updated_at: "2026-02-27"
owner: "@ronny"
scope: mint-secrets-promotion

mode:
  default_policy: report
  enforce_requires_clean_report_runs: 3
  report_cert_file: docs/planning/W45E_SECRETS_PROMOTION_CERT_20260227.md

modules:
  shipping:
    namespace: /spine/services/shipping
    runtime_config: /Users/ronnyworks/code/mint-modules/shipping/src/config.ts
    runtime_env_keys:
      - API_KEY
      - JWT_SECRET
      - DATABASE_URL
      - EASYPOST_API_KEY
      - EASYPOST_WEBHOOK_SECRET
    aliases:
      API_KEY: SHIPPING_API_KEY
      JWT_SECRET: SHIPPING_JWT_SECRET
      DATABASE_URL: SHIPPING_DATABASE_URL
      EASYPOST_API_KEY: SHIPPING_EASYPOST_API_KEY
      EASYPOST_WEBHOOK_SECRET: SHIPPING_EASYPOST_WEBHOOK_SECRET

  payment:
    namespace: /spine/services/payment
    runtime_config: /Users/ronnyworks/code/mint-modules/payment/src/config.ts
    runtime_env_keys:
      - API_KEY
      - JWT_SECRET
      - DATABASE_URL
      - STRIPE_SECRET_KEY
      - STRIPE_WEBHOOK_SECRET
    aliases:
      API_KEY: PAYMENT_API_KEY
      JWT_SECRET: PAYMENT_JWT_SECRET
      DATABASE_URL: PAYMENT_DATABASE_URL
      STRIPE_SECRET_KEY: PAYMENT_STRIPE_SECRET_KEY
      STRIPE_WEBHOOK_SECRET: PAYMENT_STRIPE_WEBHOOK_SECRET

  notifications:
    namespace: /spine/services/notifications
    runtime_config: /Users/ronnyworks/code/mint-modules/notifications/src/config.ts
    runtime_env_keys:
      - API_KEY
      - JWT_SECRET
    aliases:
      API_KEY: NOTIFICATIONS_API_KEY
      JWT_SECRET: NOTIFICATIONS_JWT_SECRET

shared_dependencies:
  notifications_provider_namespace: /spine/services/communications
  notifications_provider_keys:
    - RESEND_API_KEY
    - FROM_EMAIL
    - ADMIN_EMAIL
    - TWILIO_ACCOUNT_SID
    - TWILIO_AUTH_TOKEN
    - TWILIO_PHONE_NUMBER
  notifications_provider_key_path_overrides:
    FROM_EMAIL: /spine/integrations/commerce-mail

source_contracts:
  namespace_policy: ops/bindings/secrets.namespace.policy.yaml
  runway_contract: ops/bindings/secrets.runway.contract.yaml
  bundle_contract: ops/bindings/secrets.bundle.contract.yaml

policy:
  generic_runtime_keys:
    - API_KEY
    - JWT_SECRET
    - DATABASE_URL
    - EASYPOST_API_KEY
    - EASYPOST_WEBHOOK_SECRET
    - STRIPE_SECRET_KEY
    - STRIPE_WEBHOOK_SECRET
  report_mode_allows_findings: true
  enforce_mode_requires_zero_findings: true
