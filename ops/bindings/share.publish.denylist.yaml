# Share Publish Denylist
#
# Patterns that MUST NOT be published to the GitHub share channel.
# Any file matching these patterns will be blocked from publish operations.
#
# Status: authoritative
# Last verified: 2026-02-13
# Owner: @ronny

version: "1.0"
updated: "2026-02-13"

# ─────────────────────────────────────────────────────────────
# SECRET TOKENS
# ─────────────────────────────────────────────────────────────
#
# These patterns detect various secret/token formats.
# Any match BLOCKS the publish operation.

secret_patterns:
  - id: "github-pat-classic"
    pattern: 'ghp_[a-zA-Z0-9]{36}'
    description: "GitHub personal access token (classic)"
    severity: critical

  - id: "github-oauth-token"
    pattern: 'gho_[a-zA-Z0-9]{36}'
    description: "GitHub OAuth access token"
    severity: critical

  - id: "github-user-token"
    pattern: 'ghu_[a-zA-Z0-9]{36}'
    description: "GitHub user-to-server token"
    severity: critical

  - id: "github-server-token"
    pattern: 'ghs_[a-zA-Z0-9]{36}'
    description: "GitHub server-to-server token"
    severity: critical

  - id: "github-refresh-token"
    pattern: 'ghr_[a-zA-Z0-9]{36}'
    description: "GitHub refresh token"
    severity: critical

  - id: "github-fine-grained-pat"
    pattern: 'github_pat_[a-zA-Z0-9_]{22,}'
    description: "GitHub fine-grained personal access token"
    severity: critical

  - id: "private-key-marker"
    pattern: 'BEGIN\s+(RSA\s+)?PRIVATE\s+KEY'
    description: "PEM private key marker"
    severity: critical

  - id: "infisical-token"
    pattern: 'st\.[a-zA-Z0-9]{22,}'
    description: "Infisical service token"
    severity: critical

# ─────────────────────────────────────────────────────────────
# CREDENTIAL PATTERNS
# ─────────────────────────────────────────────────────────────

credential_patterns:
  - id: "postgres-url-with-auth"
    pattern: 'postgres(ql)?://[^:]+:[^@]+@'
    description: "PostgreSQL connection string with embedded credentials"
    severity: critical

  - id: "mysql-url-with-auth"
    pattern: 'mysql://[^:]+:[^@]+@'
    description: "MySQL connection string with embedded credentials"
    severity: critical

  - id: "mongodb-url-with-auth"
    pattern: 'mongodb(\+srv)?://[^:]+:[^@]+@'
    description: "MongoDB connection string with embedded credentials"
    severity: critical

  - id: "redis-url-with-auth"
    pattern: 'redis://[^:]*:[^@]+@'
    description: "Redis connection string with password"
    severity: high

  - id: "api-key-assignment"
    pattern: '(?i)api[_-]?key\s*[=:]\s*'
    description: "API key assignment in code/config"
    severity: high

  - id: "password-assignment"
    pattern: '(?i)password\s*[=:]\s*'
    description: "Password assignment in code/config"
    severity: critical

  - id: "secret-assignment"
    pattern: '(?i)secret\s*[=:]\s*'
    description: "Secret assignment in code/config"
    severity: high

  - id: "token-assignment"
    pattern: '(?i)token\s*[=:]\s*'
    description: "Token assignment in code/config"
    severity: high

# ─────────────────────────────────────────────────────────────
# MACHINE IDENTITY PATTERNS
# ─────────────────────────────────────────────────────────────
#
# These patterns detect machine-specific or user-specific identifiers.

identity_patterns:
  - id: "local-username-path"
    pattern: '/Users/[a-zA-Z]+/'
    description: "macOS user home path (machine-specific)"
    severity: medium

  - id: "tailscale-hostname"
    pattern: '[a-zA-Z0-9\-]+\.ts\.net'
    description: "Tailscale hostname reference"
    severity: medium

  - id: "local-ip-v4-private"
    pattern: '192\.168\.[0-9]{1,3}\.[0-9]{1,3}'
    description: "Private IPv4 address (RFC1918)"
    severity: low

  - id: "local-ip-v4-home"
    pattern: '10\.0\.[0-9]{1,3}\.[0-9]{1,3}'
    description: "Home network IPv4 address"
    severity: low

  - id: "local-ip-v4-shop"
    pattern: '10\.10\.[0-9]{1,3}\.[0-9]{1,3}'
    description: "Shop network IPv4 address"
    severity: low

# ─────────────────────────────────────────────────────────────
# PRIVATE INFRASTRUCTURE PATTERNS
# ─────────────────────────────────────────────────────────────

infrastructure_patterns:
  - id: "proxmox-hostname"
    pattern: '(?i)proxmox|pve|pve-[0-9]+'
    description: "Proxmox VE host references"
    severity: medium

  - id: "idrac-reference"
    pattern: '(?i)idrac|iDRAC'
    description: "Dell iDRAC references"
    severity: medium

  - id: "vm-hostname-pattern"
    pattern: '[a-z]+-[0-9]{3}\.local'
    description: "VM hostname pattern"
    severity: medium

  - id: "nas-hostname"
    pattern: '(?i)synology|nas-[a-z]+'
    description: "NAS device references"
    severity: medium

# ─────────────────────────────────────────────────────────────
# LOCAL RUNTIME PATTERNS
# ─────────────────────────────────────────────────────────────

runtime_patterns:
  - id: "launchd-label"
    pattern: 'com\.[a-z]+\.[a-z-]+'
    description: "launchd service label pattern"
    severity: low

  - id: "launchd-path"
    pattern: '/Library/LaunchAgents/|/Library/LaunchDaemons/'
    description: "launchd configuration paths"
    severity: low

# ─────────────────────────────────────────────────────────────
# EXCLUDED FILE TYPES
# ─────────────────────────────────────────────────────────────
#
# These file types are always blocked regardless of content.

excluded_extensions:
  - extension: ".env"
    description: "Environment files"
    severity: critical

  - extension: ".pem"
    description: "PEM certificate/key files"
    severity: critical

  - extension: ".key"
    description: "Key files"
    severity: critical

  - extension: ".p12"
    description: "PKCS#12 certificate bundle"
    severity: critical

  - extension: ".pfx"
    description: "PFX certificate bundle"
    severity: critical

# ─────────────────────────────────────────────────────────────
# EXCLUDED DIRECTORIES
# ─────────────────────────────────────────────────────────────

excluded_directories:
  - path: "mailroom/"
    description: "Runtime mailroom state and queues"
    severity: critical

  - path: "receipts/"
    description: "Session receipts with sensitive context"
    severity: high

  - path: ".secrets/"
    description: "Secrets directory"
    severity: critical

  - path: "secrets/"
    description: "Secrets directory (alternate)"
    severity: critical
