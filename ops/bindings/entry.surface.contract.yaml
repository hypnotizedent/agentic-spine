# Entry Surface Contract
# Status: authoritative
# Last verified: 2026-02-22

version: 3
updated_at: "2026-02-22"
owner: "@ronny"
scope: startup-entry-parity

startup_block:
  marker_start: "<!-- SPINE_STARTUP_BLOCK -->"
  marker_end: "<!-- /SPINE_STARTUP_BLOCK -->"
  required_lines:
    - "cd ~/code/agentic-spine"
    - "./bin/ops cap run session.start"
  # Post-work verify (NOT in startup block — runs after domain changes, before commit):
  #   ./bin/ops cap run verify.route.recommend
  #   ./bin/ops cap run verify.pack.run <domain>
  # Release/nightly only:
  #   ./bin/ops cap run verify.release.run

surfaces:
  - id: codex
    path: AGENTS.md
  - id: claude_project
    path: CLAUDE.md
  - id: opencode
    path: ~/code/workbench/dotfiles/opencode/OPENCODE.md
  # claude_home (~/.claude/CLAUDE.md) is a redirect shim only — governed by D46, not D124.
  # It does not carry the startup block and is not an agent entry surface.

# Gateway-first routing policy (AOF v1.1 Move 1 cutover)
# All surfaces should declare the spine gateway as primary MCP server.
# Domain-specific MCP servers (finance-agent, mint-*) are optional supplements.
# spine-rag is absorbed by the gateway and should not appear as a standalone server.
routing_policy:
  model: gateway-first
  primary_server: spine
  absorbed_servers:
    - spine-rag
  supplemental_servers:
    - finance-agent
    - mint-pricing
    - mint-suppliers
    - MCP_DOCKER
    - playwright
