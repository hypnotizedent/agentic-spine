# Services Health Binding
# Non-secret. Spine-native. Read-only HTTP probes.
#
# Source SSOT: docs/governance/SERVICE_REGISTRY.yaml
# Each endpoint is a known service health URL (no auth required).

version: 1

defaults:
  connect_timeout_sec: 5
  max_time_sec: 10

endpoints:
  - id: mint-os-api
    host: docker-host
    url: "http://100.92.156.118:3335/health"
    expect: 200
    notes: "Mint OS Dashboard API"

  - id: minio
    host: docker-host
    url: "http://100.92.156.118:9000/minio/health/live"
    expect: 200
    notes: "MinIO storage"

  - id: infisical
    host: infra-core
    url: "http://100.92.91.128:8088/api/status"
    expect: 200
    notes: "Infisical internal health (no auth)"

  - id: vaultwarden
    host: infra-core
    url: "http://100.92.91.128:8081/alive"
    expect: 200
    notes: "Vaultwarden liveness"

  - id: authentik
    host: infra-core
    url: "http://100.92.91.128:9000/if/flow/initial-setup/"
    expect: 200
    notes: "Authentik initial setup / health-like endpoint"

  - id: pihole
    host: infra-core
    url: "http://100.92.91.128:8053/admin/"
    expect: 302
    notes: "Pi-hole admin UI (no auth required for login page)"

  - id: n8n
    host: automation-stack
    url: "http://100.98.70.70:5678/healthz"
    expect: 200
    notes: "n8n workflow automation"

  - id: open-webui
    host: automation-stack
    url: "http://100.98.70.70:3000/"
    expect: 200
    notes: "Open WebUI chat interface (automation-stack)"

  - id: ollama
    host: automation-stack
    url: "http://100.98.70.70:11434/api/tags"
    expect: 200
    notes: "Ollama API (automation-stack)"

  - id: prometheus
    host: observability
    url: "http://100.120.163.70:9090/-/healthy"
    expect: 200
    notes: "Prometheus metrics"

  - id: grafana
    host: observability
    url: "http://100.120.163.70:3000/api/health"
    expect: 200
    notes: "Grafana dashboards"

  - id: loki
    host: observability
    url: "http://100.120.163.70:3100/ready"
    expect: 200
    notes: "Loki log aggregation"

  - id: uptime-kuma
    host: observability
    url: "http://100.120.163.70:3001"
    expect: 302
    notes: "Uptime Kuma monitoring"

  - id: node-exporter
    host: observability
    url: "http://100.120.163.70:9100/metrics"
    expect: 200
    notes: "Node exporter host metrics"

  - id: gitea
    host: dev-tools
    url: "http://100.90.167.39:3000/api/healthz"
    expect: 200
    notes: "Gitea Git forge"

  - id: qdrant
    host: ai-consolidation
    url: "http://100.71.17.29:6333/healthz"
    expect: 200
    notes: "Qdrant vector DB (VM 207)"

  - id: anythingllm
    host: ai-consolidation
    url: "http://100.71.17.29:3002/api/ping"
    expect: 200
    notes: "AnythingLLM RAG interface (VM 207)"

  # ─── Download Stack (VM 209) ───────────────────────────────────────
  - id: radarr
    host: download-stack
    url: "http://100.107.36.76:7878/ping"
    expect: 200
    notes: "Radarr movie management"

  - id: sonarr
    host: download-stack
    url: "http://100.107.36.76:8989/ping"
    expect: 200
    notes: "Sonarr TV management"

  - id: prowlarr
    host: download-stack
    url: "http://100.107.36.76:9696/ping"
    expect: 200
    notes: "Prowlarr indexer manager"

  - id: lidarr
    host: download-stack
    url: "http://100.107.36.76:8686/ping"
    expect: 200
    notes: "Lidarr music management"

  - id: sabnzbd
    host: download-stack
    url: "http://100.107.36.76:8080/"
    expect: 200
    notes: "SABnzbd Usenet downloader web UI"

  - id: tdarr
    host: download-stack
    url: "http://100.107.36.76:8265/"
    expect: 200
    notes: "Tdarr transcode automation web UI"

  - id: flaresolverr
    host: download-stack
    url: "http://100.107.36.76:8191/health"
    expect: 200
    notes: "FlareSolverr challenge solver"

  - id: download-node-exporter
    host: download-stack
    url: "http://100.107.36.76:9100/metrics"
    expect: 200
    notes: "Node exporter on download-stack"

  # ─── Streaming Stack (VM 210) ────────────────────────────────────
  - id: jellyfin
    host: streaming-stack
    url: "http://100.123.207.64:8096/health"
    expect: 200
    notes: "Jellyfin video streaming"

  - id: navidrome
    host: streaming-stack
    url: "http://100.123.207.64:4533/ping"
    expect: 200
    notes: "Navidrome music streaming"

  - id: jellyseerr
    host: streaming-stack
    url: "http://100.123.207.64:5055"
    expect: 307
    notes: "Jellyseerr request management (307 redirect to login is healthy)"

  - id: bazarr
    host: streaming-stack
    url: "http://100.123.207.64:6767/ping"
    expect: 200
    notes: "Bazarr subtitle management"

  - id: homarr
    host: streaming-stack
    url: "http://100.123.207.64:7575/"
    expect: 307
    notes: "Homarr dashboard (307 redirect to login is healthy)"

  - id: streaming-node-exporter
    host: streaming-stack
    url: "http://100.123.207.64:9100/metrics"
    expect: 200
    notes: "Node exporter on streaming-stack"
