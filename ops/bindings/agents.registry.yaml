# ═══════════════════════════════════════════════════════════════════════════
# Agent Registry — Domain Agent Discovery SSOT
# ═══════════════════════════════════════════════════════════════════════════
#
# Purpose: single lookup surface for sessions to discover domain-specific
# agents. Every new Claude Code session gets this injected via
# generate-context.sh so agents know where to route domain problems.
#
# This file is the SSOT for which agents exist, what domains they cover,
# and where their implementation lives.
#
# Adding agent N+1:
#   1. Create contract: ops/agents/<agent-id>.contract.md
#   2. Add entry here under agents[]
#   3. Add routing rule under routing_rules[]
#   4. Verify: ops cap run spine.verify (D49 validates)
#
# Status: authoritative
# Last verified: 2026-02-08
# ═══════════════════════════════════════════════════════════════════════════

version: 2
updated: "2026-02-11"

agents:
  - id: media-agent
    domain: media
    description: "Media stack application layer: language profiles, quality settings, subtitle prefs, library hygiene, troubleshooting"
    contract: "ops/agents/media-agent.contract.md"
    implementation: "~/code/workbench/agents/media/"
    implementation_status: active
    mcp_type: custom
    mcp_server: "~/code/workbench/agents/media/tools/"
    mcpjungle_mirror: "~/code/workbench/infra/compose/mcpjungle/servers/media-stack/"
    loop: "LOOP-MEDIA-AGENT-WORKBENCH-20260208"
    covers:
      - download-stack (VM 209)
      - streaming-stack (VM 210)
    services:
      - radarr
      - sonarr
      - lidarr
      - prowlarr
      - sabnzbd
      - jellyfin
      - navidrome
      - jellyseerr
      - bazarr
      - recyclarr

  - id: n8n-agent
    domain: automation
    description: "n8n workflow governance: naming, versioning, export/import discipline, safe execution, failure triage"
    contract: "ops/agents/n8n-agent.contract.md"
    implementation: "~/code/workbench/agents/n8n/"
    implementation_status: active
    mcp_type: custom
    mcp_server: "~/code/workbench/agents/n8n/tools/"
    mcpjungle_mirror: "~/code/workbench/infra/compose/mcpjungle/servers/n8n/"
    loop: "LOOP-N8N-AGENT-20260209"
    covers:
      - automation-stack (VM 202)
    services:
      - n8n

  - id: home-assistant-agent
    domain: home-automation
    description: "Home Assistant application layer: automations, device/entity management, service calls (blocked pending spine cap)"
    contract: "ops/agents/home-assistant-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/home-assistant/"
    implementation_status: active
    mcp_type: custom
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers:
      - proxmox-home VM 100
    services:
      - home-assistant

  - id: mint-os-agent
    domain: commerce
    description: "MintPrints e-commerce operations: order emails, production updates, supplier orders (all blocked pending spine review)"
    contract: "ops/agents/mint-os-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/mint-os/"
    implementation_status: active
    mcp_type: custom
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers:
      - docker-host (VM 200)
    services:
      - mint-os

  - id: mint-agent
    domain: product
    description: "Mint modules operator tooling: seed queries, upload listing, job lookup, intake validation, health checks (V1 read-only)"
    contract: "ops/agents/mint-agent.contract.md"
    implementation: "~/code/mint-modules/agents/mcp-server/"
    implementation_status: active
    mcp_type: custom
    loop: "CP-20260212T105000Z"
    covers:
      - mint-apps (VM 213)
      - mint-data (VM 212)
    services:
      - files-api
      - order-intake
      - quote-page

  - id: firefly-agent
    domain: finance
    description: "Firefly III personal finance: transaction queries, account/budget views (config-only MCP, read-only)"
    contract: "ops/agents/firefly-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/firefly.json"
    implementation_status: active
    mcp_type: config-only
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers:
      - finance-stack (VM 211)
    services:
      - firefly-iii-vm211

  - id: paperless-agent
    domain: documents
    description: "Paperless-ngx document management: search, retrieval, tag management (config-only MCP, read-only)"
    contract: "ops/agents/paperless-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/paperless.json"
    implementation_status: active
    mcp_type: config-only
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers:
      - finance-stack (VM 211)
    services:
      - paperless-ngx-vm211

  - id: immich-agent
    domain: photos
    description: "Immich photo/video management: search, albums, asset metadata, deduplication governance (read-only)"
    contract: "ops/agents/immich-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/immich-photos/"
    implementation_status: active
    mcp_type: custom
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers:
      - immich (VM 203)
    services:
      - immich

  - id: ms-graph-agent
    domain: identity
    description: "Microsoft Graph API: email, calendar, identity queries (config-only MCP, read-only)"
    contract: "ops/agents/ms-graph-agent.contract.md"
    implementation: "~/code/workbench/infra/compose/mcpjungle/servers/microsoft-graph.json"
    implementation_status: active
    mcp_type: config-only
    loop: "LOOP-MCP-RUNTIME-GOVERNANCE-20260211"
    covers: []  # Cloud-only (Microsoft 365); no infrastructure VM binding
    services:
      - microsoft-graph

# ─────────────────────────────────────────────────────────────────────────
# Routing Rules
# ─────────────────────────────────────────────────────────────────────────
#
# When a session encounters a problem in a domain, these rules tell it
# which agent to consult. The "keywords" field lists terms that should
# trigger routing to the agent.
#
routing_rules:
  - agent: media-agent
    domains:
      - media
      - streaming
      - downloads
    keywords:
      - jellyfin
      - radarr
      - sonarr
      - lidarr
      - prowlarr
      - sabnzbd
      - navidrome
      - jellyseerr
      - bazarr
      - recyclarr
      - subtitle
      - audio track
      - language profile
      - quality profile
      - wrong language
      - missing subtitles
      - download queue
      - media library

  - agent: n8n-agent
    domains:
      - automation
      - workflows
      - ops
    keywords:
      - n8n
      - workflow
      - webhook
      - trigger
      - cron
      - schedule
      - execution
      - automation

  - agent: home-assistant-agent
    domains:
      - home-automation
      - smart-home
    keywords:
      - home assistant
      - hass
      - zigbee
      - z-wave
      - entity
      - dashboard
      - lovelace
      - SLZB-06

  - agent: mint-os-agent
    domains:
      - commerce
      - e-commerce
    keywords:
      - mint-os
      - mintprints
      - order
      - production
      - sanmar
      - s&s activewear
      - print

  - agent: mint-agent
    domains:
      - product
      - artwork
      - intake
    keywords:
      - seed
      - seeds
      - artwork
      - quote
      - intake
      - job
      - upload
      - files-api
      - mint-modules

  - agent: firefly-agent
    domains:
      - finance
      - personal-finance
    keywords:
      - firefly
      - transaction
      - budget
      - account
      - simplefin
      - bank

  - agent: paperless-agent
    domains:
      - documents
      - document-management
    keywords:
      - paperless
      - document
      - receipt
      - scan
      - tag
      - correspondent

  - agent: immich-agent
    domains:
      - photos
      - media-library
    keywords:
      - immich
      - photo
      - album
      - asset
      - dedupe
      - library

  - agent: ms-graph-agent
    domains:
      - identity
      - email
      - calendar
    keywords:
      - microsoft
      - graph
      - outlook
      - email
      - calendar
      - office 365
