# ═══════════════════════════════════════════════════════════════════════════
# Agent Registry — Domain Agent Discovery SSOT
# ═══════════════════════════════════════════════════════════════════════════
#
# Purpose: single lookup surface for sessions to discover domain-specific
# agents. Every new Claude Code session gets this injected via
# generate-context.sh so agents know where to route domain problems.
#
# This file is the SSOT for which agents exist, what domains they cover,
# and where their implementation lives.
#
# Adding agent N+1:
#   1. Create contract: ops/agents/<agent-id>.contract.md
#   2. Add entry here under agents[]
#   3. Add routing rule under routing_rules[]
#   4. Verify: ops cap run spine.verify (D49 validates)
#
# Status: authoritative
# Last verified: 2026-02-08
# ═══════════════════════════════════════════════════════════════════════════

version: 1
updated: "2026-02-09"

agents:
  - id: media-agent
    domain: media
    description: "Media stack application layer: language profiles, quality settings, subtitle prefs, library hygiene, troubleshooting"
    contract: "ops/agents/media-agent.contract.md"
    implementation: "~/code/workbench/agents/media/"
    implementation_status: active
    loop: "LOOP-MEDIA-AGENT-WORKBENCH-20260208"
    covers:
      - download-stack (VM 209)
      - streaming-stack (VM 210)
    services:
      - radarr
      - sonarr
      - lidarr
      - prowlarr
      - sabnzbd
      - jellyfin
      - navidrome
      - jellyseerr
      - bazarr
      - recyclarr

  - id: n8n-agent
    domain: automation
    description: "n8n workflow governance: naming, versioning, export/import discipline, safe execution, failure triage"
    contract: "ops/agents/n8n-agent.contract.md"
    implementation: "~/code/workbench/agents/n8n/"
    implementation_status: active
    loop: "LOOP-N8N-AGENT-20260209"
    covers:
      - automation-stack (VM 202)
    services:
      - n8n

# ─────────────────────────────────────────────────────────────────────────
# Routing Rules
# ─────────────────────────────────────────────────────────────────────────
#
# When a session encounters a problem in a domain, these rules tell it
# which agent to consult. The "keywords" field lists terms that should
# trigger routing to the agent.
#
routing_rules:
  - agent: media-agent
    domains:
      - media
      - streaming
      - downloads
    keywords:
      - jellyfin
      - radarr
      - sonarr
      - lidarr
      - prowlarr
      - sabnzbd
      - navidrome
      - jellyseerr
      - bazarr
      - recyclarr
      - subtitle
      - audio track
      - language profile
      - quality profile
      - wrong language
      - missing subtitles
      - download queue
      - media library

  - agent: n8n-agent
    domains:
      - automation
      - workflows
      - ops
    keywords:
      - n8n
      - workflow
      - webhook
      - trigger
      - cron
      - schedule
      - execution
      - automation
