# Status: authoritative
# Last verified: 2026-02-25

version: 1
updated_at: "2026-02-25"
owner: "@ronny"
scope: communications-provider-routing

transactional:
  mode: live
  cutover_phase: phase1-resend-live
  customer_notifications_canonical_provider: resend
  default_sender_email: "noreply@mintprints.com"
  default_sender_name: "Mint Prints"
  default_sms_from: "+15619335513"
  phase_matrix:
    phase0-simulation:
      description: "Safety default: transactional providers remain simulated."
      resend_execution_mode: simulation-only
      twilio_execution_mode: simulation-only
    phase1-resend-live:
      description: "Canary phase: Resend live, Twilio still simulated."
      resend_execution_mode: live
      twilio_execution_mode: simulation-only
    phase2-full-live:
      description: "Full transactional live phase: Resend + Twilio live."
      resend_execution_mode: live
      twilio_execution_mode: live

providers:
  microsoft:
    provider_type: mailbox-ops
    channels:
      - email
    status: active
    execution_mode: manual-only
    capability: microsoft.mail.send
    description: "Operator mailbox surfaces only (manual send path; no automated routing)."
  resend:
    provider_type: transactional-email
    channels:
      - email
    status: active
    execution_mode: live
    api_base: "https://api.resend.com"
    required_env:
      - RESEND_API_KEY
      - FROM_EMAIL
    description: "Canonical transactional email provider for customer notifications."
  twilio:
    provider_type: transactional-sms
    channels:
      - sms
    status: active
    execution_mode: simulation-only
    api_base: "https://api.twilio.com/2010-04-01"
    required_env:
      - TWILIO_ACCOUNT_SID
      - TWILIO_AUTH_TOKEN
      - TWILIO_PHONE_NUMBER
    description: "Canonical transactional SMS provider for customer notifications."

write_authority:
  allowed_mailboxes_now:
    - spine@spine.ronny.works
    - alerts@spine.ronny.works
  mint_customer_service_mailbox_enabled: false
  block_outlook_personal_mailboxes: true

routing:
  message_types:
    quote_created:
      email_provider: resend
      sms_provider: twilio
    quote_ready:
      email_provider: resend
      sms_provider: twilio
    payment_needed:
      email_provider: resend
      sms_provider: twilio
    order_ready:
      email_provider: resend
      sms_provider: twilio
    shipped:
      email_provider: resend
      sms_provider: twilio
    custom:
      email_provider: resend
      sms_provider: twilio
  boundaries:
    quote_alerts:
      canonical_email_provider: resend
      forbidden_email_providers:
        - microsoft
        - stalwart
      forbidden_sender_domains:
        - spine.ronny.works
