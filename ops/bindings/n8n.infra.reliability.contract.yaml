# n8n Infrastructure Reliability Contract
# Status: authoritative
# Last verified: 2026-02-16
# Scope: n8n-infra-reliability

version: "1.0"
updated: "2026-02-16"
owner: "@ronny"
scope: n8n-infra-reliability

checks:
  service_health:
    source_binding: ops/bindings/services.health.yaml
    endpoint_id: n8n
    expected_http: 200

  api_auth:
    required_env: N8N_API_KEY
    default_api_url: https://n8n.ronny.works
    probe_path: /api/v1/workflows?limit=1
    expected_http: 200

  snapshot:
    check_script: ops/plugins/n8n/bin/n8n-snapshot-status
    max_age_hours: 26

  backup_inventory:
    source_binding: ops/bindings/backup.inventory.yaml
    target_name: app-n8n-workflows
    require_enabled: true

policy:
  sprint_scope: "infra_reliability_only"
  workflow_logic_mutations: "deferred"

