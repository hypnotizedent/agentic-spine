# Status: authoritative
# Last verified: 2026-02-24

version: 1
updated: "2026-02-24T16:00:00Z"

infisical:
  project_id: "01ddd93a-e0f8-4c7c-ad9f-903d76ef94d9"
  environment: "prod"

namespace:
  canonical_base_path: "/spine"
  vm_infra_path: "/spine/vm-infra"

rules:
  # Required key placements for active VM-infra services.
  required_key_paths:
    AUTHENTIK_SECRET_KEY: "/spine/vm-infra/caddy-auth"
    AUTHENTIK_DB_PASSWORD: "/spine/vm-infra/caddy-auth"
    TAILSCALE_AUTH_KEY: "/spine/vm-infra/provisioning"
    TAILSCALE_API_KEY: "/spine/vm-infra/provisioning"
    GITEA_DB_PASSWORD: "/spine/vm-infra/gitea"
    GITEA_SECRET_KEY: "/spine/vm-infra/gitea"
    GITEA_INTERNAL_TOKEN: "/spine/vm-infra/gitea"
    GITEA_ADMIN_PASSWORD: "/spine/vm-infra/gitea"
    GITEA_API_TOKEN: "/spine/vm-infra/gitea"
    GITEA_RUNNER_TOKEN: "/spine/vm-infra/gitea"
    GITEA_OAUTH_CLIENT_ID: "/spine/vm-infra/gitea"
    GITEA_OAUTH_CLIENT_SECRET: "/spine/vm-infra/gitea"
    GITHUB_PUSH_MIRROR_TOKEN: "/spine/vm-infra/gitea"
    VAULTWARDEN_ADMIN_TOKEN: "/spine/vm-infra/vaultwarden"
    GRAFANA_ADMIN_PASSWORD: "/spine/vm-infra/grafana"
    AUTHENTIK_API_TOKEN: "/spine/vm-infra/caddy-auth"
    SIG_KEY: "/spine/vm-infra/ai-consolidation"
    SIG_SALT: "/spine/vm-infra/ai-consolidation"
    RADARR_API_KEY: "/spine/vm-infra/media-stack/download"
    SONARR_API_KEY: "/spine/vm-infra/media-stack/download"
    LIDARR_API_KEY: "/spine/vm-infra/media-stack/download"
    PRIVADO_VPN_USER: "/spine/vm-infra/media-stack/download"
    PRIVADO_VPN_PASS: "/spine/vm-infra/media-stack/download"

  # Planned key placements (not enforced until the service is migrated to Infisical).
  # Media keys promoted to key_path_overrides per LOOP-MEDIA-SECRETS-CANONICAL-TRACE-20260225.
  # Provisioning tracked in GAP-OP-904.
  planned_key_paths:
    # Automation stack
    N8N_ENCRYPTION_KEY: "/spine/vm-infra/automation-stack"
    # Home vaultwarden (VM 102): DECOMMISSIONED 2026-02-16. Superseded by infra-core (VM 204).
    # VAULTWARDEN_HOME_* keys removed — see VAULTWARDEN_ADMIN_TOKEN at /spine/vm-infra/vaultwarden.
    # Mint OS vendor/supplier keys
    EASYPOST_API_KEY: "/spine/integrations/mint-os-vendors"
    SS_ACTIVEWEAR_API_KEY: "/spine/integrations/mint-os-vendors"
    SS_ACTIVEWEAR_USERNAME: "/spine/integrations/mint-os-vendors"
    ASCOLOUR_API_KEY: "/spine/integrations/mint-os-vendors"
    ASCOLOUR_API_SECRET: "/spine/integrations/mint-os-vendors"
    SANMAR_FTP_USER: "/spine/integrations/mint-os-vendors"
    SANMAR_FTP_PASSWORD: "/spine/integrations/mint-os-vendors"
  # Module namespace policy (MINT_PRODUCT_GOVERNANCE.md section 5):
  # - Each mint module gets a dedicated /spine/services/<module>/ namespace.
  # - No module may add new keys to the deprecated mint-os-api Infisical project.
  # - Shared secrets (e.g. MinIO credentials) are duplicated per namespace.
  # - Infisical folder creation + key population happens during module sprint work.
  # - GAP-OP-105 FIXED: governance enforcement in place.
  module_namespaces:
    artwork: "/spine/services/artwork"
    quote-page: "/spine/services/quote-page"
    order-intake: "/spine/services/order-intake"
    pricing: "/spine/services/pricing"
    suppliers: "/spine/services/suppliers"
    shipping: "/spine/services/shipping"
    payment: "/spine/services/payment"
    notifications: "/spine/services/notifications"
    mint-shared-infra: "/spine/services/mint-shared-infra"

  # Consumer path overrides used by spine tooling to resolve key reads/writes.
  key_path_overrides:
    AZURE_CLIENT_ID: "/spine/platform/security"
    AZURE_CLIENT_SECRET: "/spine/platform/security"
    AZURE_TENANT_ID: "/spine/platform/security"
    GITHUB_PERSONAL_ACCESS_TOKEN: "/spine/platform/security"  # canonical name
    GITHUB_TOKEN: "/spine/platform/security"  # alias used in docker-compose build args
    INFISICAL_AUTH_SECRET: "/spine/platform/security"
    INFISICAL_ENCRYPTION_KEY: "/spine/platform/security"
    INFISICAL_MCP_CLIENT_ID: "/spine/platform/security"
    INFISICAL_MCP_CLIENT_SECRET: "/spine/platform/security"
    INFISICAL_POSTGRES_PASSWORD: "/spine/platform/security"
    CF_ACCESS_CLIENT_ID: "/spine/network/edge"
    CF_ACCESS_CLIENT_SECRET: "/spine/network/edge"
    CLOUDFLARE_ACCOUNT_ID: "/spine/network/edge"
    CLOUDFLARE_API_TOKEN: "/spine/network/edge"
    CLOUDFLARE_AUTH_EMAIL: "/spine/network/edge"
    CLOUDFLARE_GLOBAL_API_KEY: "/spine/network/edge"
    CLOUDFLARE_TUNNEL_ID: "/spine/network/edge"
    CLOUDFLARE_TUNNEL_TOKEN: "/spine/network/edge"
    PIHOLE_HOME_PASSWORD: "/spine/network/edge"
    PIHOLE_WEB_PASSWORD: "/spine/network/edge"
    XB8_GATEWAY_PASSWORD: "/spine/network/edge"
    XB8_GATEWAY_URL: "/spine/network/edge"
    XB8_GATEWAY_USER: "/spine/network/edge"
    MINIO_ROOT_USER: "/spine/storage/minio"
    MINIO_ROOT_PASSWORD: "/spine/storage/minio"
    DOCKER_HOST_SMB_PASS: "/spine/storage/nas"
    DOCKER_HOST_SMB_USER: "/spine/storage/nas"
    SMB_PASSWORD: "/spine/storage/nas"
    SYNOLOGY_HOST: "/spine/storage/nas"
    SYNOLOGY_SSH_PASSWORD: "/spine/storage/nas"
    SYNOLOGY_SSH_USER: "/spine/storage/nas"
    APPLE_APP_PASSWORD: "/spine/integrations/commerce-mail"
    APPLE_ID_EMAIL: "/spine/integrations/commerce-mail"
    FROM_EMAIL: "/spine/integrations/commerce-mail"
    ADMIN_EMAIL: "/spine/services/communications"
    RESEND_API_KEY: "/spine/services/communications"
    TWILIO_ACCOUNT_SID: "/spine/services/communications"
    TWILIO_AUTH_TOKEN: "/spine/services/communications"
    TWILIO_PHONE_NUMBER: "/spine/services/communications"
    SHOPIFY_CLIENT_ID: "/spine/integrations/commerce-mail"
    SHOPIFY_CLIENT_SECRET: "/spine/integrations/commerce-mail"
    SHOPIFY_WEBHOOK_SECRET: "/spine/integrations/commerce-mail"
    SHOPIFY_CLI_TOKEN: "/spine/integrations/commerce-mail"
    SHOPIFY_PARTNER_API_KEY: "/spine/integrations/commerce-mail"
    SHOPIFY_PARTNER_ID: "/spine/integrations/commerce-mail"
    SHOPIFY_STORE_DOMAIN: "/spine/integrations/commerce-mail"
    GRAFANA_ADMIN_PASSWORD: "/spine/vm-infra/grafana"
    VAULTWARDEN_ADMIN_TOKEN_PLAINTEXT: "/spine/vm-infra/vaultwarden"
    VAULTWARDEN_BW_CLIENTID: "/spine/vm-infra/vaultwarden"
    VAULTWARDEN_BW_CLIENTSECRET: "/spine/vm-infra/vaultwarden"
    VAULTWARDEN_BW_MASTER_PASSWORD: "/spine/vm-infra/vaultwarden"
    VAULTWARDEN_BW_SERVER_URL: "/spine/vm-infra/vaultwarden"
    VAULTWARDEN_RECOVERY_ARCHIVE_PASSWORD: "/spine/vm-infra/vaultwarden"
    IMMICH_API_KEY: "/spine/services/immich"
    IMMICH_HYPNO_API_KEY: "/spine/services/immich"
    IMMICH_HYPNO_PASSWORD: "/spine/services/immich"
    IMMICH_HYPNO_USER_ID: "/spine/services/immich"
    IMMICH_MINT_API_KEY: "/spine/services/immich"
    IMMICH_SUDO_PASSWORD: "/spine/services/immich"
    RADARR_API_KEY: "/spine/vm-infra/media-stack/download"
    SONARR_API_KEY: "/spine/vm-infra/media-stack/download"
    LIDARR_API_KEY: "/spine/vm-infra/media-stack/download"
    PRIVADO_VPN_USER: "/spine/vm-infra/media-stack/download"
    PRIVADO_VPN_PASS: "/spine/vm-infra/media-stack/download"
    HUNTARR_USER: "/spine/vm-infra/media-stack/download"
    HUNTARR_PASSWORD: "/spine/vm-infra/media-stack/download"
    AUTOPULSE_PASSWORD: "/spine/vm-infra/media-stack/download"
    REAL_DEBRID_API_KEY: "/spine/vm-infra/media-stack/download"
    QBITTORRENT_USERNAME: "/spine/vm-infra/media-stack/download"
    QBITTORRENT_PASSWORD: "/spine/vm-infra/media-stack/download"
    # Media stack — streaming (promoted from planned per LOOP-MEDIA-SECRETS-CANONICAL-TRACE-20260225)
    JELLYFIN_API_KEY: "/spine/vm-infra/media-stack/streaming"
    SPOTIFY_CLIENT_ID: "/spine/vm-infra/media-stack/streaming"
    SPOTIFY_CLIENT_SECRET: "/spine/vm-infra/media-stack/streaming"
    NAVIDROME_USERNAME: "/spine/vm-infra/media-stack/streaming"
    NAVIDROME_PASSWORD: "/spine/vm-infra/media-stack/streaming"
    LASTFM_API_KEY: "/spine/vm-infra/media-stack/streaming"
    LASTFM_SECRET: "/spine/vm-infra/media-stack/streaming"
    MAIL_ARCHIVER_ADMIN_PASS: "/spine/services/mail-archiver"
    MAIL_ARCHIVER_DB_PASS: "/spine/services/mail-archiver"
    FIREFLY_ACCESS_TOKEN: "/spine/services/finance"
    FIREFLY_API_URL: "/spine/services/finance"
    FINANCE_ADAPTER_API_KEY: "/spine/services/finance"
    SIMPLEFIN_TOKEN: "/spine/services/finance"
    SIMPLEFIN_ACCESS_URL: "/spine/services/finance"
    FIREFLY_APP_KEY: "/spine/services/finance"
    GHOSTFOLIO_ACCESS_TOKEN: "/spine/services/finance"
    GHOSTFOLIO_ACCESS_TOKEN_SALT: "/spine/services/finance"
    GHOSTFOLIO_JWT_SECRET: "/spine/services/finance"
    CALENDAR_HOME_RADICALE_ADMIN_USERNAME: "/spine/services/communications"
    CALENDAR_HOME_RADICALE_ADMIN_PASSWORD: "/spine/services/communications"
    STALWART_ADMIN_PASSWORD: "/spine/services/communications"
    STALWART_OPS_PASSWORD: "/spine/services/communications"
    STALWART_NOREPLY_PASSWORD: "/spine/services/communications"
    STALWART_ALERTS_PASSWORD: "/spine/services/communications"
    NAMECHEAP_API_KEY: "/spine/platform/registrar"
    NAMECHEAP_API_USER: "/spine/platform/registrar"
    NAMECHEAP_CLIENT_IP: "/spine/platform/registrar"
    NAMECHEAP_USERNAME: "/spine/platform/registrar"
    PAPERLESS_API_TOKEN: "/spine/services/paperless"
    POSTGRES_API_PASSWORD: "/spine/services/mint-os-db"
    MCPJUNGLE_ADMIN_TOKEN: "/spine/services/mcpjungle"
    # Mint module — artwork (files-api) — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    ARTWORK_DATABASE_URL: "/spine/services/artwork"
    ARTWORK_MINIO_ACCESS_KEY: "/spine/services/artwork"
    ARTWORK_MINIO_SECRET_KEY: "/spine/services/artwork"
    ARTWORK_API_KEY: "/spine/services/artwork"
    ARTWORK_PRESIGNED_UPLOAD_EXPIRY: "/spine/services/artwork"
    ARTWORK_PRESIGNED_DOWNLOAD_EXPIRY: "/spine/services/artwork"
    # Mint module — quote-page — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    QUOTE_PAGE_MINIO_ACCESS_KEY: "/spine/services/quote-page"
    QUOTE_PAGE_MINIO_SECRET_KEY: "/spine/services/quote-page"
    QUOTE_PAGE_FILES_API_URL: "/spine/services/quote-page"
    # Mint module — shipping — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    SHIPPING_API_KEY: "/spine/services/shipping"
    SHIPPING_JWT_SECRET: "/spine/services/shipping"
    SHIPPING_DATABASE_URL: "/spine/services/shipping"
    SHIPPING_EASYPOST_API_KEY: "/spine/services/shipping"
    SHIPPING_EASYPOST_WEBHOOK_SECRET: "/spine/services/shipping"
    # Mint module — pricing — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    PRICING_API_KEY: "/spine/services/pricing"
    PRICING_DATABASE_URL: "/spine/services/pricing"
    # Mint module — suppliers — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    SUPPLIERS_API_KEY: "/spine/services/suppliers"
    SUPPLIERS_DATABASE_URL: "/spine/services/suppliers"
    # Mint module — payment — enforced per MINT_PRODUCT_GOVERNANCE.md section 5
    PAYMENT_API_KEY: "/spine/services/payment"
    PAYMENT_JWT_SECRET: "/spine/services/payment"
    PAYMENT_DATABASE_URL: "/spine/services/payment"
    PAYMENT_STRIPE_SECRET_KEY: "/spine/services/payment"
    PAYMENT_STRIPE_WEBHOOK_SECRET: "/spine/services/payment"
    # Mint module — notifications — enforced per W45 secrets promotion contract
    NOTIFICATIONS_API_KEY: "/spine/services/notifications"
    NOTIFICATIONS_JWT_SECRET: "/spine/services/notifications"
    ANTHROPIC_API_KEY: "/spine/ai/providers"
    OPENAI_API_KEY: "/spine/ai/providers"
    Z_AI_API_KEY: "/spine/ai/providers"
    ANYTHINGLLM_API_KEY: "/spine/ai/providers"
    MORPH_API_KEY: "/spine/ai/providers"
    # Home Assistant API token (home-assistant/prod)
    HA_API_TOKEN: "/spine/home/ha"
    # Home Vaultwarden (VM 102): DECOMMISSIONED 2026-02-16. VAULTWARDEN_HOME_* overrides removed.
    # Active vaultwarden on infra-core (VM 204) uses VAULTWARDEN_ADMIN_TOKEN at /spine/vm-infra/vaultwarden.
    # Shop network device credentials (LAN-only, password-based SSH)
    AP_SSH_PASSWORD: "/spine/shop/wifi"
    AP_SSH_USER: "/spine/shop/wifi"
    # Shop UniFi controller credentials (UDR6 local API)
    UNIFI_SHOP_USER: "/spine/shop/unifi"
    UNIFI_SHOP_PASSWORD: "/spine/shop/unifi"
    UNIFI_SHOP_API_KEY: "/spine/shop/unifi"
    # Shop NVR credentials (Hikvision ISAPI)
    NVR_ADMIN_USER: "/spine/shop/nvr"
    NVR_ADMIN_PASSWORD: "/spine/shop/nvr"
    # Shop iDRAC credentials (Dell R730XD BMC)
    IDRAC_ADMIN_USER: "/spine/shop/idrac"
    IDRAC_ADMIN_PASSWORD: "/spine/shop/idrac"
    # Shop switch credentials (Dell N2024P)
    SWITCH_ADMIN_USER: "/spine/shop/switch"
    SWITCH_ADMIN_PASSWORD: "/spine/shop/switch"

  # Prefixes that are never allowed at root path '/'.
  forbidden_root_prefixes:
    - "AUTHENTIK_"
    - "CADDY_"
    - "GRAFANA_"
    - "LOKI_"
    - "PROMETHEUS_"
    - "UPTIME_KUMA_"
    - "TAILSCALE_"
    - "GITEA_"
    - "VAULTWARDEN_"
    - "VM_INFRA_"
    - "RADARR_"
    - "SONARR_"
    - "LIDARR_"
    - "JELLYFIN_"
    - "NAVIDROME_"
    - "AUTOPULSE_"
    - "ARTWORK_"
    - "QUOTE_PAGE_"

  # Exact root keys that must be absent after cutover cleanup.
  forbidden_root_keys:
    - "AZURE_CLIENT_ID"
    - "AZURE_CLIENT_SECRET"
    - "AZURE_TENANT_ID"
    - "CLOUDFLARE_ACCOUNT_ID"
    - "CLOUDFLARE_API_TOKEN"
    - "CLOUDFLARE_AUTH_EMAIL"
    - "CLOUDFLARE_GLOBAL_API_KEY"
    - "CLOUDFLARE_TUNNEL_ID"
    - "CLOUDFLARE_TUNNEL_TOKEN"
    - "GITHUB_PERSONAL_ACCESS_TOKEN"
    - "INFISICAL_AUTH_SECRET"
    - "INFISICAL_ENCRYPTION_KEY"
    - "INFISICAL_MCP_CLIENT_ID"
    - "INFISICAL_MCP_CLIENT_SECRET"
    - "INFISICAL_POSTGRES_PASSWORD"
    - "PIHOLE_HOME_PASSWORD"
    - "DOCKER_HOST_SMB_PASS"
    - "DOCKER_HOST_SMB_USER"
    - "XB8_GATEWAY_PASSWORD"
    - "XB8_GATEWAY_URL"
    - "XB8_GATEWAY_USER"
    - "SMB_PASSWORD"
    - "SYNOLOGY_HOST"
    - "SYNOLOGY_SSH_PASSWORD"
    - "SYNOLOGY_SSH_USER"
    - "APPLE_APP_PASSWORD"
    - "APPLE_ID_EMAIL"
    - "FROM_EMAIL"
    - "SHOPIFY_CLIENT_ID"
    - "SHOPIFY_CLIENT_SECRET"
    - "SHOPIFY_WEBHOOK_SECRET"
    - "SHOPIFY_CLI_TOKEN"
    - "SHOPIFY_PARTNER_API_KEY"
    - "SHOPIFY_PARTNER_ID"
    - "SHOPIFY_STORE_DOMAIN"
    - "IMMICH_API_KEY"
    - "IMMICH_HYPNO_API_KEY"
    - "IMMICH_HYPNO_PASSWORD"
    - "IMMICH_HYPNO_USER_ID"
    - "IMMICH_MINT_API_KEY"
    - "IMMICH_SUDO_PASSWORD"
    - "MAIL_ARCHIVER_ADMIN_PASS"
    - "MAIL_ARCHIVER_DB_PASS"
    - "FIREFLY_ACCESS_TOKEN"
    - "FINANCE_ADAPTER_API_KEY"
    - "SIMPLEFIN_TOKEN"
    - "CALENDAR_HOME_RADICALE_ADMIN_PASSWORD"
    - "CALENDAR_HOME_RADICALE_ADMIN_USERNAME"
    - "STALWART_ADMIN_PASSWORD"
    - "STALWART_OPS_PASSWORD"
    - "STALWART_NOREPLY_PASSWORD"
    - "STALWART_ALERTS_PASSWORD"
    - "PIHOLE_WEB_PASSWORD"
    - "NAMECHEAP_API_KEY"
    - "NAMECHEAP_API_USER"
    - "NAMECHEAP_CLIENT_IP"
    - "NAMECHEAP_USERNAME"
    - "PAPERLESS_API_TOKEN"
    - "MCPJUNGLE_ADMIN_TOKEN"
    - "ANTHROPIC_API_KEY"
    - "OPENAI_API_KEY"
    - "Z_AI_API_KEY"
    - "ANYTHINGLLM_API_KEY"

freeze:
  mode: "hard_zero"
  root_path: "/"
  captured_at: "2026-02-24T16:00:00Z"

  # Hard enforcement: root path '/' must remain empty.
  allowed_root_keys: []
