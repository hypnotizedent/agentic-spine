# Share Publish Remote Contract
#
# Machine-enforced binding for the one-way share channel.
# D82 validates this binding exists and is internally consistent.
#
# Status: authoritative
# Last verified: 2026-02-13
# Owner: @ronny

version: "1.0"
updated: 2026-02-28

remote:
  name: "share"
  url_ref: "github-share-channel"
  # Actual URL is NOT stored here (contains identity).
  # The remote must be configured locally: git remote add share <url>
  target_branch: "main"

flow:
  mode: "one-way"
  direction: "spine -> share"
  push_policy: "manual"
  dry_run_default: true

guardrails:
  require_clean_tree: true
  require_spine_verify_pass: true
  require_allowlist_scan: true
  require_denylist_scan: true
  require_receipt: true

# The share remote is NOT the canonical remote.
# Gitea (origin) remains the single source of truth.
# D62 enforces origin/main == github/main parity.
# The share channel is a separate, curated downstream.
authority:
  canonical_remote: "origin"
  share_remote: "share"
  canonical_takes_precedence: true
