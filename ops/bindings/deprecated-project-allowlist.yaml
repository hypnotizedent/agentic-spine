# Deprecated Project Reference Allowlist
# Status: authoritative
# Last verified: 2026-02-13
# Purpose: Explicit list of scripts permitted to reference deprecated Infisical
#          project names (finance-stack, mint-os-vault, mint-os-portal).
# Consumed by: D71 gate (surfaces/verify/d71-deprecated-ref-allowlist-lock.sh)
# Policy: Only operator-only scripts that need full project inventory for
#         backup, bootstrap, or testing are allowed. Agent-facing scripts
#         must target active projects only.
#
# To add: append entry with justification. D71 gate enforces this list.

version: 1
updated: "2026-02-12"

# Deprecated project names (from secrets.inventory.yaml lifecycle field)
deprecated_projects:
  - finance-stack
  - mint-os-vault
  # mint-os-portal deleted 2026-02-12

# Allowlisted scripts: operator-only tools that legitimately reference
# all project names (including deprecated) for backup/bootstrap/test.
# These scripts have NO agent access path.
allowlist:
  - path: scripts/agents/infisical-agent.sh
    reason: "Contains deprecated detection/guard system (is_deprecated_project, guard_deprecated_write)"
  - path: scripts/root/bootstrap-secrets.sh
    reason: "Operator bootstrap: maps all project names to UUIDs for initial provisioning"
  - path: scripts/root/backup/backup-infisical-secrets.sh
    reason: "Operator backup: exports all projects for disaster recovery"
  - path: scripts/root/test-infisical.sh
    reason: "Operator test: validates connectivity to all projects"
  - path: scripts/root/docker-safe.sh
    reason: "Operator utility: references finance-stack as directory/service name (not API call)"
  - path: scripts/finance/deploy-finance-stack.sh
    reason: "Operator deployment: deploys finance stack to VM 211 (service name reference)"
  - path: scripts/finance/backup-finance-stack.sh
    reason: "Operator backup: backs up finance stack data (service name reference)"
  - path: scripts/finance/backup-firefly.sh
    reason: "Operator migration note references legacy finance-stack naming while stack moves to VM 211"
  - path: scripts/finance/paperless-sync.sh
    reason: "Operator migration note references legacy finance-stack naming while stack moves to VM 211"
  - path: scripts/finance/scan-to-paperless.sh
    reason: "Operator migration note references legacy finance-stack naming while stack moves to VM 211"
  - path: scripts/finance/simplefin-daily-sync.sh
    reason: "Operator migration note references legacy finance-stack naming while stack moves to VM 211"

# Scan scope: workbench/scripts/** excluding docs/legacy
scan_root: "scripts"
scan_exclude:
  - "*.md"
  - "docs/"
  - "legacy/"
