---
version: "1.0"
updated_at: "2026-02-15"
scope: identity-contract-schema

$schema: https://json-schema.org/draft/2020-12/schema
type: object
required:
  - version
  - identity
properties:
  version:
    type: string
    const: "1.0"
    description: "Identity contract schema version"
    
  identity:
    type: object
    required:
      - node_id
      - deployed_at
      - spine_version
    properties:
      node_id:
        type: string
        description: "Unique node identifier (usually hostname)"
        pattern: "^[a-z0-9-]+$"
        
      deployed_at:
        type: string
        format: date-time
        description: "ISO 8601 timestamp of spine deployment"
        
      spine_version:
        type: string
        description: "Spine kernel version deployed"
        pattern: "^v[0-9]+\\.[0-9]+\\.[0-9]+$"
        
      org:
        type: string
        description: "Organization identifier"
        
      role:
        type: string
        enum: [brain, runner, edge, product, standalone]
        default: standalone
        description: "Node role in the fabric"
        
      environment:
        type: string
        description: "Reference to environment name"
        
      contact:
        type: string
        description: "Contact email or identifier"
        
      orchestrator:
        type: object
        properties:
          url:
            type: string
            format: uri
            description: "Orchestrator URL (if this node registers)"
          token_secret:
            type: string
            description: "Secret path for registration token"
        description: "Orchestrator connection (brain role only)"
        
  secrets_binding:
    type: object
    properties:
      provider:
        type: string
        enum: [infisical, vault, aws_secrets, gcp_secret_manager, none]
        default: none
        description: "Secrets provider"
      project:
        type: string
        description: "Project/workspace identifier"
      environment:
        type: string
        description: "Secrets environment (dev/staging/prod)"
    description: "Secrets provider binding"
    
  telemetry:
    type: object
    properties:
      enabled:
        type: boolean
        default: false
      endpoint:
        type: string
        format: uri
      interval_seconds:
        type: integer
        default: 60
    description: "Telemetry configuration"
