# Status: authoritative
# Last verified: 2026-02-22

version: 1
updated_at: "2026-02-22"
owner: "@ronny"
scope: communications-stack-ws1

pilot:
  stage: ws1-live-pilot
  provider: stalwart
  execution_backend: microsoft-graph
  graph:
    cap_exec: "ops/plugins/ms-graph/bin/graph-cap-exec"
    live_probe_query: "*"
    search_default_top: 10
  vm_target:
    hostname: communications-stack
    vm_id: "214"
    profile: spine-ready-v1
    proxmox_host: pve
  send_test:
    mode: live-pilot
    manual_approval_required: true
    default_sender: spine@spine.ronny.works
    default_recipient: spine@spine.ronny.works
    allowed_recipient_domains:
      - spine.ronny.works
      - mintprints.com
      - communications.local
  mailboxes:
    - id: ops
      address: ops@spine.ronny.works
      role: operations
      status: active
      routing_mode: stalwart-direct
    - id: alerts
      address: alerts@spine.ronny.works
      role: alerting
      status: active
      routing_mode: stalwart-direct
    - id: noreply
      address: noreply@spine.ronny.works
      role: system
      status: active
      routing_mode: stalwart-direct

transactional:
  mode: live
  preview_link_required_for_execute: true
  provider_contract: "ops/bindings/communications.providers.contract.yaml"
  policy_contract: "ops/bindings/communications.policy.contract.yaml"
  templates_contract: "ops/bindings/communications.templates.catalog.yaml"
  delivery_contract: "ops/bindings/communications.delivery.contract.yaml"
