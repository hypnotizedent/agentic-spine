# RAG Workspace Contract
# Canonical binding for RAG workspace configuration.
# Authority: docs/governance/RAG_INDEXING_RULES.md, docs/governance/RAG_QUERY_PATTERNS.md
# Consumed by: ops/plugins/rag/bin/rag, surfaces/verify/d87-rag-workspace-contract-lock.sh

schema_version: '1.0'
updated: '2026-02-13'

workspace:
  slug: "agentic-spine"
  description: "Spine-native RAG workspace for governed agent knowledge"
  provider: "anythingllm"
  provider_version: ">=1.0.0"

embedding:
  model: "mxbai-embed-large:latest"
  provider: "ollama"
  vector_store: "qdrant"

index_policy:
  eligible_roots:
    - "docs/"
    - "ops/"
    - "surfaces/"
  exclusion_prefixes:
    - "docs/legacy/"
    - "docs/governance/_audits/"
    - "docs/governance/_archived/"
    - "docs/governance/_imported/"
    - "receipts/"
    - "mailroom/state/"
    - "fixtures/"
    - ".git/"
    - "node_modules/"
  frontmatter_required:
    - "status:"
    - "owner:"
    - "last_verified:"
  secrets_filter: true

sync_policy:
  upload_timeout_sec: 180
  retry_count: 1
  retry_delay_sec: 5
  checkpoint_dir: "mailroom/state/rag-sync"
  dry_run_first: recommended

cutover_policy:
  verify_workspace_exists: true
  verify_parity_after_sync: true
  smoke_test_queries:
    - "What is the canonical session entry protocol file?"
    - "How do I file a gap?"
  acceptance_criteria: "docs_indexed >= docs_eligible AND smoke queries return sources"
